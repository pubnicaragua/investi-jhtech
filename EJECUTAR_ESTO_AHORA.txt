============================================================================
üî• EJECUTAR ESTO AHORA - CR√çTICO
============================================================================

PROBLEMA: El error persiste porque NO ejecutaste el SQL en Supabase

ERROR:
‚ùå [getSuggestedPeople] Error: {"code": "42846", "message": "COALESCE could not convert type uuid[] to text[]"}

SOLUCI√ìN: Ejecutar FIX_CRITICO_AHORA.sql EN SUPABASE

============================================================================
PASO 1: EJECUTAR SQL EN SUPABASE (OBLIGATORIO)
============================================================================

1. Abrir Supabase SQL Editor
2. Copiar TODO el contenido de: FIX_CRITICO_AHORA.sql
3. Ejecutar (Run)
4. Verificar mensaje: "Funci√≥n corregida"

2. Ejecutar: sql/fix_notifications_table.sql
   - Agrega columnas: related_id, related_type, from_user_id
   - Permite notificaciones de likes

============================================================================
PASO 2: REINICIAR APP
============================================================================

npx expo start --clear

============================================================================
CORRECCIONES APLICADAS EN C√ìDIGO
============================================================================

1. ‚úÖ HomeFeedScreen.tsx
   - Mensaje al guardar: "‚úì Guardado - Publicaci√≥n guardada exitosamente"
   - M√°s sutil que antes

2. ‚úÖ NotificationsModal.tsx
   - Muestra hasta 20 notificaciones (antes 5)
   - Incluye nombre del usuario: "Juan recomend√≥ tu publicaci√≥n"
   - Navega correctamente al hacer click
   - Tipos soportados: like, comment, follow, message

3. ‚úÖ PickKnowledgeScreen.tsx
   - Bot√≥n "Continuar" m√°s abajo (marginTop: 60)

4. ‚úÖ Badges din√°micos (YA ESTABAN BIEN)
   - Chat: muestra unreadMessagesCount
   - Notificaciones: muestra unreadCount
   - Se actualizan en tiempo real

============================================================================
LOGS ESPERADOS DESPU√âS DE EJECUTAR SQL
============================================================================

‚úÖ CORRECTO:
```
üîç [getSuggestedPeople] Buscando personas para userId: [uuid] limit: 10
‚úÖ [getSuggestedPeople] Personas recomendadas: X
üìä [getSuggestedPeople] Scores: [...]
```

‚ùå NO DEBE APARECER:
```
‚ùå COALESCE could not convert type uuid[] to text[]
‚ùå operator does not exist: text = uuid
```

============================================================================
NOTIFICACIONES - MEJORAS APLICADAS
============================================================================

ANTES:
- Solo 5 notificaciones
- "Nuevo mensaje" sin nombre
- No navegaba al hacer click

AHORA:
- Hasta 20 notificaciones
- "Nuevo mensaje de Juan P√©rez"
- Navega a PostDetail, Profile, o ChatList seg√∫n tipo
- Tipos de mensaje:
  * like ‚Üí "Juan recomend√≥ tu publicaci√≥n"
  * comment ‚Üí "Mar√≠a coment√≥ tu publicaci√≥n"
  * follow ‚Üí "Pedro comenz√≥ a seguirte"
  * message ‚Üí "Nuevo mensaje de Ana"

============================================================================
BADGES DIN√ÅMICOS - CONFIRMACI√ìN
============================================================================

‚úÖ Chat (MessageSquare icon):
- L√≠nea 916-920 en HomeFeedScreen.tsx
- Badge muestra: unreadMessagesCount
- Se actualiza con loadConversations()

‚úÖ Notificaciones (Bell icon):
- L√≠nea 903-908 en HomeFeedScreen.tsx
- Badge muestra: unreadCount
- Se actualiza con loadNotifications()
- Suscripci√≥n en tiempo real activa

PROBLEMA REPORTADO:
"Me carga como que tuviera 31 notificaciones pero solo me cargan 3"

CAUSA POSIBLE:
- La funci√≥n getNotifications() cuenta TODAS las notificaciones
- Pero el modal solo mostraba 5 (ahora 20)
- El badge muestra el total de NO LE√çDAS
- El modal muestra las √∫ltimas 20

SOLUCI√ìN:
- Ahora muestra 20 notificaciones en el modal
- El badge sigue mostrando el total de NO LE√çDAS
- Esto es correcto: badge = total no le√≠das, modal = √∫ltimas 20

============================================================================
RESUMEN DE ARCHIVOS MODIFICADOS
============================================================================

1. FIX_CRITICO_AHORA.sql (EJECUTAR EN SUPABASE)
2. sql/fix_notifications_table.sql (EJECUTAR EN SUPABASE)
3. src/screens/HomeFeedScreen.tsx
4. src/components/NotificationsModal.tsx
5. src/screens/PickKnowledgeScreen.tsx

============================================================================
CHECKLIST FINAL
============================================================================

[ ] 1. Ejecutar FIX_CRITICO_AHORA.sql en Supabase
[ ] 2. Ejecutar sql/fix_notifications_table.sql en Supabase
[ ] 3. npx expo start --clear
[ ] 4. Probar: CommunityRecommendationsScreen ‚Üí Debe mostrar personas
[ ] 5. Probar: Guardar post ‚Üí Debe mostrar "‚úì Guardado"
[ ] 6. Probar: Ver notificaciones ‚Üí Debe mostrar nombre de usuario
[ ] 7. Probar: Click en notificaci√≥n ‚Üí Debe navegar correctamente
[ ] 8. Probar: Badge de chat ‚Üí Debe mostrar n√∫mero correcto
[ ] 9. Probar: Badge de notificaciones ‚Üí Debe mostrar n√∫mero correcto

============================================================================
